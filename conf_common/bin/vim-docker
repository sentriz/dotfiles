#!/usr/bin/env bash

if [[ $# -eq 1 ]]; then
    echo "please provide a base" >&2
    exit 1
fi

base="$(sed -r 's/.*\-(\w+)$/\1/' <<<"$0")"
image="vim-docker-$base"

if [[ -z "$(docker images -q "$image")" ]]; then
    pushd "$HOME/.config/nvim/"
    docker build \
        --tag "$image" \
        --file "Dockerfile-$base" \
        .
    popd
fi

docker run -it --volume "$PWD:/project" "$image"
