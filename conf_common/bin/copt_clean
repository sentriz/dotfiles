#!/usr/bin/env python3

from glob import glob
import os
import sys
import yaml

if 'DOTS_COPT_DIR' not in os.environ:
    print('DOTS_COPT_DIR not set', file=sys.stderr)
    sys.exit(1)

glob_pattern = os.path.join(
    os.environ['DOTS_COPT_DIR'],
    '*/docker-compose.yml',
)
for filename in glob(glob_pattern):
    with open(filename) as file:
        before = yaml.load(file)
    with open(filename, 'w') as file:
        yaml.dump(before, file, default_flow_style=False)
