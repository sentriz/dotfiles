#!/usr/bin/env fish

if test (count $argv) -ne 1
    echo "please provide token, or '-' for stdin" >&2
    exit 1
end

set -l token "$argv[1]"

test $token = -
and set -l token (cat)

echo "$token" | read -d '.' header payload signature
test -z "$header" -o -z "$payload"
and exit 1

echo "$header" | base64 --decode --ignore-garbage 2>/dev/null
echo
echo "$payload" | base64 --decode --ignore-garbage 2>/dev/null
echo
