##################################################
# bindsym format                                 #
##################################################
# mod + ...         => window/float related      #
# mod + shift + ... => window/float move related #
# mod + ctrl + ...  => lauching software         #
# mod + alt + ...   => modes                     #
##################################################


set $super Mod4
set $alt Mod1
set $locker lock
set $update_blocks_audio pkill -RTMIN+1 i3blocks
floating_modifier $super

font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
font pango:DejaVu Sans Mono 17px

### goodies
popup_during_fullscreen smart
for_window [class="^.*"] border pixel 2
gaps inner 24
smart_borders on

bar {
    i3bar_command i3bar -t
    status_command i3blocks
    output primary
    tray_padding 0
    tray_output primary
    colors {
        separator          #00000000
        background         #30303060
        statusline         #dddddd
        #                  border    background  text
        focused_workspace  #0088CC   #0088CC     #ffffff
        active_workspace   #303030   #303030     #ffffff
        inactive_workspace #30303060 #30303060   #ffffff
        urgent_workspace   #2f343a00 #ff000090   #ffffff
    }
}

bar {
    i3bar_command i3bar -t
    output DP2-1
    tray_output primary
    colors {
        separator          #00000000
        background         #30303060
        statusline         #dddddd
        #                  border    background  text
        focused_workspace  #0088CC   #0088CC     #ffffff
        active_workspace   #303030   #303030     #ffffff
        inactive_workspace #30303060 #30303060   #ffffff
        urgent_workspace   #2f343a00 #ff000090   #ffffff
    }
}

### keybindings (window/float related)
bindsym $super+q kill
bindsym $super+f fullscreen toggle
bindsym $super+space floating toggle
bindsym $super+b move position center

bindsym $super+bracketleft move workspace to output left
bindsym $super+bracketright move workspace to output right

# change focus
bindsym $super+h focus left
bindsym $super+j focus down
bindsym $super+k focus up
bindsym $super+l focus right

# move focused window
bindsym $super+Left move left
bindsym $super+Down move down
bindsym $super+Up move up
bindsym $super+Right move right

# set split direction
bindsym $super+n split h
bindsym $super+m split v

# change container layout (stacked, tabbed, toggle split, focus parent)
bindsym $super+z layout stacking
bindsym $super+x layout tabbed
bindsym $super+c layout toggle split
bindsym $super+v focus parent

### keybindings (modes)
bindsym $super+$alt+r     mode $mode_resize_tile
bindsym $super+$alt+space mode $mode_move_floating focus floating
bindsym $super+$alt+q     mode $mode_system
bindsym $super+$alt+v     mode $mode_audio
bindsym $super+$alt+i     mode $mode_i3
bindsym $super+$alt+p     mode $mode_pass
bindsym $super+$alt+s     mode $mode_scrot
bindsym $super+$alt+g     mode $mode_gaps
bindsym $super+$alt+b     mode $mode_gamma

set $mode_resize_tile "resize mode: [h][j][k][l]"
mode $mode_resize_tile {
    bindsym h resize shrink width 10 px or 10 ppt
    bindsym j resize grow height 10 px or 10 ppt
    bindsym k resize shrink height 10 px or 10 ppt
    bindsym l resize grow width 10 px or 10 ppt
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_system "system mode: [l]ock, [s]uspend, [h]ibernate, [r]eboot, shut[d]own"
mode $mode_system {
    bindsym l exec --no-startup-id $locker;                                           mode default
    bindsym d exec --no-startup-id $locker; exec --no-startup-id systemctl poweroff;  mode default
    bindsym h exec --no-startup-id $locker; exec --no-startup-id systemctl hibernate; mode default
    bindsym r exec --no-startup-id $locker; exec --no-startup-id systemctl reboot;    mode default
    bindsym s exec --no-startup-id $locker; exec --no-startup-id systemctl suspend;   mode default
    bindsym Return mode default
    bindsym Escape mode default
}

set $mode_i3 "i3 mode: e[x]it, [r]estart, reload [c]onfig"
mode $mode_i3 {
    bindsym x exit
    bindsym r restart
    bindsym c reload
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_audio "volume mode: +|right +5%/+10%,  -|left +5%/+10%,  [m]ute,  [r]eset"
mode $mode_audio {
    bindsym plus          exec --no-startup-id ponymix increase 5%;     exec --no-startup-id $update_blocks_audio
    bindsym minus         exec --no-startup-id ponymix decrease 5%;     exec --no-startup-id $update_blocks_audio
    bindsym KP_Add        exec --no-startup-id ponymix increase 5%;     exec --no-startup-id $update_blocks_audio
    bindsym KP_Subtract   exec --no-startup-id ponymix decrease 5%;     exec --no-startup-id $update_blocks_audio
    bindsym Right         exec --no-startup-id ponymix increase 10%;    exec --no-startup-id $update_blocks_audio 
    bindsym Left          exec --no-startup-id ponymix decrease 10%;    exec --no-startup-id $update_blocks_audio
    bindsym m             exec --no-startup-id ponymix toggle;          exec --no-startup-id $update_blocks_audio
    bindsym r             exec --no-startup-id ponymix set-volume 100%; exec --no-startup-id $update_blocks_audio
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_move_floating "floating move mode: [h][j][k][l]"
mode $mode_move_floating {
    bindsym h     move left
    bindsym j     move down
    bindsym k     move up
    bindsym l     move right
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_scrot "screenshot mode: [n]ormal, [s]elect, [N]ormal upload, [S]elect upload"
mode $mode_scrot {
    bindsym n                 exec screenshot,                   mode "default"
    bindsym Shift+n           exec screenshot --upload,          mode "default"
    bindsym --release s       exec screenshot --select,          mode "default"
    bindsym --release Shift+s exec screenshot --select --upload, mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_pass "pass mode: [m]anual, [u]ser, [p]assword, [b]oth"
mode $mode_pass {
    bindsym m exec dmenu_pass,                 mode "default"
    bindsym u exec dmenu_pass --tuser,         mode "default"
    bindsym p exec dmenu_pass --tpass,         mode "default"
    bindsym b exec dmenu_pass --tuser --tpass, mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
 
set $mode_gaps "gaps: [o]uter, [i]nner"
mode $mode_gaps {
    bindsym o      mode $mode_gaps_outer
    bindsym i      mode $mode_gaps_inner
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
 
set $mode_gaps_inner "gaps inner: -|+|0 (local), shift -|+|0 (global)"
mode $mode_gaps_inner {
    bindsym plus  gaps inner current plus 5
    bindsym minus gaps inner current minus 5
    bindsym 0     gaps inner current set 0
    bindsym Shift+plus  gaps inner all plus 5
    bindsym Shift+minus gaps inner all minus 5
    bindsym Shift+0     gaps inner all set 0
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_gaps_outer "gaps outer: -|+|0 (local), shift -|+|0 (global)"
mode $mode_gaps_outer {
    bindsym plus  gaps outer current plus 5
    bindsym minus gaps outer current minus 5
    bindsym 0     gaps outer current set 0
    bindsym Shift+plus  gaps outer all plus 5
    bindsym Shift+minus gaps outer all minus 5
    bindsym Shift+0     gaps outer all set 0
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $mode_gamma "gamma: -|+|0"
mode $mode_gamma {
    bindsym plus  exec gamma +0.1
    bindsym minus exec gamma -0.1
    bindsym 0     exec gamma 1
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

### workspaces
set $work1 "1 main"
set $work2 "2 web"
set $work3 "3 term i"
set $work4 "4 term ii"
set $work5 "5 vm"
set $work6 "6 chat"
set $work7 "7 mnem"
set $work8 "8 gimp"
set $work9 "9 office"

# switch to workspace
bindsym $super+1 workspace $work1
bindsym $super+2 workspace $work2
bindsym $super+3 workspace $work3
bindsym $super+4 workspace $work4
bindsym $super+5 workspace $work5
bindsym $super+6 workspace $work6
bindsym $super+7 workspace $work7
bindsym $super+8 workspace $work8
bindsym $super+9 workspace $work9

bindsym $super+0 [urgent=latest] focus
bindsym $super+grave workspace back_and_forth

# move focused container to workspace
bindsym $super+Shift+1 move container to workspace $work1
bindsym $super+Shift+2 move container to workspace $work2
bindsym $super+Shift+3 move container to workspace $work3
bindsym $super+Shift+4 move container to workspace $work4
bindsym $super+Shift+5 move container to workspace $work5
bindsym $super+Shift+6 move container to workspace $work6
bindsym $super+Shift+7 move container to workspace $work7
bindsym $super+Shift+8 move container to workspace $work8
bindsym $super+Shift+9 move container to workspace $work9

### keeping programs on workspaces
assign [class="Sqliteman"] $work1
assign [class="DB Browser for SQLite"] $work1
assign [class="Firefox"] $work2
assign [class="Chromium"] $work2
assign [class="Google-chrome"] $work2
assign [class="URxvt" instance="ncmpcpp"] $work4
assign [class="Spotify"] $work4
assign [class="Deadbeef"] $work4
assign [class="Surf" instance="^plex_surf$"] $work4
assign [class="Franz"] $work6
assign [class="Mnemosyne"] $work7
assign [class="Anki"] $work7
assign [class="Gimp*"] $work8
assign [class="Inkscape"] $work8
assign [class="libreoffice-*"] $work9
assign [class="VirtualBox"] $work5
for_window [title="^Plex$"] move to workspace $work4, floating disable
for_window [class="Spotify"] move to workspace $work4

# floating
for_window [class="Pavucontrol"]                          floating enable
for_window [class="Mnemosyne"]                            floating enable
for_window [class="Galculator"]                           floating enable
for_window [class="etcher"]                               floating enable
for_window [class="Qpaeq"]                                floating enable
for_window [class="Anki"]                                 floating enable
for_window [class="Gui.py"]                               floating enable
for_window [class="SimpleScreenRecorder"]                 floating enable
for_window [title="^bobby$"]                              floating enable
for_window [class="feh"]                                  floating enable
for_window [class="^Terminator$" window_role="^scratch$"] floating enable
for_window [class="Blueman-manager"]                      floating enable
for_window [class="Woeusbgui"]                            floating enable
for_window [class="Nm-connection-editor"]                 floating enable
for_window [class="electrum"]                             floating enable

# floating generic
for_window [window_type="menu"]        floating enable
for_window [window_role="app"]         floating enable
for_window [window_role="pop-up"]      floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_type="dialog"]      floating enable
for_window [title="Preferences$"]      floating enable

### scratchpads (known)
for_window         [class="^Terminator$" window_role="^scratch$"] move scratchpad, border pixel 1
bindsym $super+F1  [class="^Terminator$" window_role="^scratch$"] scratchpad show, resize set 1344 575, move position center
for_window         [class="Keybase"] move scratchpad, border pixel 1 
bindsym $super+F2  [class="Keybase"] scratchpad show, resize set 1344 575, move position center
for_window         [class="Plexamp"] move scratchpad, border pixel 1
bindsym $super+F3  [class="Plexamp"] scratchpad show
#, resize set 300 377,  move position 1058 359

### scratchpads (unknown)
bindsym $super+Shift+F5 mark "c_scratch_1", move scratchpad
bindsym $super+F5 [con_mark="c_scratch_1"] scratchpad show
bindsym $super+Shift+F6 mark "c_scratch_2", move scratchpad
bindsym $super+F6 [con_mark="c_scratch_2"] scratchpad show
bindsym $super+Shift+F7 mark "c_scratch_3", move scratchpad
bindsym $super+F7 [con_mark="c_scratch_3"] scratchpad show
bindsym $super+Shift+F8 mark "c_scratch_4", move scratchpad
bindsym $super+F8 [con_mark="c_scratch_4"] scratchpad show

### keybindings (programs)
bindsym F15 exec --no-startup-id dmenu_pacs
bindsym $super+Return exec --no-startup-id terminator
bindsym ISO_Level3_Shift exec --no-startup-id emojione-picker

# keybindings (xf86 on thinkpad x220)
bindsym XF86ScreenSaver       exec --no-startup-id $locker
bindsym XF86Suspend           exec --no-startup-id gksudo systemctl hibernate
bindsym XF86Sleep             exec --no-startup-id gksudo systemctl suspend
bindsym XF86MonBrightnessUp   exec --no-startup-id xbacklight -inc 5
bindsym XF86MonBrightnessDown exec --no-startup-id xbacklight -dec 5
bindsym XF86AudioRaiseVolume  exec --no-startup-id ponymix increase 5% && $update_blocks_audio
bindsym XF86AudioLowerVolume  exec --no-startup-id ponymix decrease 5% && $update_blocks_audio
bindsym XF86AudioMute         exec --no-startup-id ponymix toggle && $update_blocks_audio
bindsym XF86AudioPlay         exec --no-startup-id playerctl play-pause
bindsym XF86AudioStop         exec --no-startup-id playerctl stop
bindsym XF86AudioNext         exec --no-startup-id playerctl next
bindsym XF86AudioPrev         exec --no-startup-id playerctl previous

bindsym Print                 exec screenshot
bindsym --release Shift+Print exec screenshot --select

# colours               # bord  # bg    # text  # indic
client.focused          #dddddd #ffffff #000000 #dddddd
client.focused_inactive #333333 #333333 #888888 #292d2e
client.unfocused        #333333 #333333 #888888 #292d2e
client.urgent           #2f343a #900000 #ffffff #900000

### todo: move this to systemd user units
exec --no-startup-id i3_startup
