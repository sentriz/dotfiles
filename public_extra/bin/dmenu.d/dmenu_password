#!/usr/bin/env bash

which wl-copy > /dev/null 2>&1 || exit 1
pass_dir=~/.password-store/
[[ ! -d "$pass_dir" ]] && exit 1
pass_list="$(find .password-store/ -type f \
    | sort \
    | grep -Po '[^\/]+\/\K(.*)(?=\.gpg)')"
wanted="$(dmenu_custom --prompt 'password' <<< "$pass_list")"
[[ -z "$wanted" ]] && exit 1
password="$(pass "$wanted")"
[[ -z "$password" ]] && exit 1
wl-copy --trim-newline <<< "$password"
wl-copy --trim-newline --primary <<< "$password"
