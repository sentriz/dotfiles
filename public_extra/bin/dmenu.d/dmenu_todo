#!/usr/bin/env bash

file=~/todo_home
height=$(cat $file | wc -l)
menu="cat $file | dmenu_custom -p 'todo:' -l $height"
selection=$(eval $menu)
while [ -n "$selection" ]; do
    if grep -q "^$selection" $file; then
        grep -v "^$selection" $file > /tmp/todo
        mv /tmp/todo $file
        height=$(($height - 1))
    else
        echo "$selection" >> $file
        height=$(($height + 1))
    fi
    menu="cat $file | dmenu_custom -p 'todo:' -l $height"
    selection=$(eval $menu)
done
