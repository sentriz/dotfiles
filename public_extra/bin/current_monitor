#!/usr/bin/env bash

# get the window position
eval "$(xdotool getmouselocation --shell)"

# compare the offset with the window coordinates for each monitor
while read name width height xoff yoff; do
    if [ "${X}" -ge "$xoff" -a \
         "${Y}" -ge "$yoff" -a \
         "${X}" -lt "$(($xoff + $width))" -a \
         "${Y}" -lt "$(($yoff + $height))" -a \
         -n "$name" ]; then
        # monitor found
        echo "$name"
        exit
    fi
done < <(
    xrandr \
        | grep -w connected \
        | sed -E 's/^([^ ]+).*\s([0-9]+)x([0-9]+)[+-]([0-9]+)[+0]([0-9]+)\s.*$/\1 \2 \3 \4 \5/g;t;d' \
        | sort -nk4,5
)

# no monitor was found
exit 1
