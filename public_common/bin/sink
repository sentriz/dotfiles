#!/usr/bin/env python3
# Senan Kelly 2016

import subprocess
import sys

raw_ponymix = subprocess.getoutput('ponymix list | egrep -A 1 "sink\s[0-9]\:*"')
list = raw_ponymix.split("\n")
sinks = {}

for line_no in range(len(list)):
    if "sink" in list[line_no]:
        sink_strs = list[line_no].split()
        sink_no = sink_strs[1].strip(":")

        raw_sink = list[line_no + 1]
        clean_sink = raw_sink.strip()
        sink_name = clean_sink.split()[:-2]
        sinks[sink_no] = " ".join(sink_name)

if __name__ == "__main__":
    for no, name in sorted(sinks.items()):
        print("{0}: {1}".format(no, name))
    print()
    try:
        sink = input("default sink: ")
    except KeyboardInterrupt:
        print()
        sys.exit(1)

    subprocess.call(["ponymix", "-d", sink, "set-default"])
    subprocess.call(["notify-send", "default audio sink", sinks[sink]])
