#!/usr/bin/env bash

if [[ "$#" -ne 1 ]]; then
    echo "please provide a key" >&2
    exit 1
fi

secret_file='/tmp/dot-secrets'

if [[ ! -e "$secret_file" ]]; then
    kbfs_mount="$(keybase config get mountdir | tr -d '"')"
    source_file="${kbfs_mount}/private/sentriz/secrets"
    cp "$source_file" "$secret_file"
    chmod 400 "$secret_file"
fi

grep -Po "^$1\ \K([^ ]+)$" "$secret_file"
