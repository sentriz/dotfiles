#!/usr/bin/env bash

if ! git rev-parse --git-dir > /dev/null 2>&1; then
    echo 'not a repo' >&2
    exit 1
fi
stash_list=$(git stash list 2> /dev/null)
stash_line=$(printf '## there are \e[32m%d stashes\e[39m' \
    "$(wc -l <<< $stash_list)")
named_stash=$(grep -Po 'On\s\w+:\s\K(.*)' <<< $stash_list)
if [[ -n "$named_stash" ]]; then
    stash_line=$(printf '%s, last named was `%s`' "$stash_line" "$named_stash")
fi
echo $stash_line
git status $@
