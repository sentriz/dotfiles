#!/usr/bin/env bash

batt_level="$(cat /sys/class/power_supply/BAT*/uevent \
    | sed -rn 's/^POWER_SUPPLY_CAPACITY=([0-9]+)$/\1/p')"

[[ -z "$batt_level" ]] && exit
[[ "$batt_level" -ge "100" ]] && exit

status="battery"
if acpi | grep -iq "\bcharging"; then
    status="charging"
fi

warning=""
if [[ "$status" = "battery" && "$batt_level" -le "10" ]]; then
    beep 1 &
    disown
    warning=" âš "
fi

echo "$status ${batt_level}%$warning"
