#!/usr/bin/env bash

if [[ "$1" = "preview" ]]; then
    row="$2"
    if grep -vqP '^\d+\t\[\[ binary data .* \]\]' <<<"$row"; then
        cliphist decode <<<"$row"
    else
        cliphist decode <<<"$row" | chafa -f sixel -s "${FZF_PREVIEW_COLUMNS}x${FZF_PREVIEW_LINES}"
    fi
    exit 0
fi

if [[ "$#" -gt 0 ]]; then
    cliphist decode <<<"$1" | wl-copy
    exit 0
fi

cliphist list
