#!/usr/bin/env bash

if ! type -p ponymix >/dev/null; then
    echo "please install ponymix" >&2
    exit 1
fi

sink_row="$(
    ponymix list --short --sink  \
        | awk -F '\t' '{print $2 "\t" tolower($4)}' \
        | dmenu_custom -p 'sink'
)"
test -z "$sink_row" && exit 1

sink_id="$(awk -F '\t' '{print $1}' <<<"$sink_row")"
ponymix set-default --sink --device "$sink_id"
ponymix list --short --sink-input \
    | awk -F '\t' '{print $2}' \
    | xargs -L 1 -I {} ponymix --sink-input --device {} move "$sink_id"
