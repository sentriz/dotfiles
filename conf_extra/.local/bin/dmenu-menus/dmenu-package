#!/usr/bin/env bash

function applications() {
    IFS=: read -r -d '' -a paths < <(printf '%s:\0' "$XDG_DATA_DIRS")
    for path in "${paths[@]}"; do
        find "$path/applications" -name '*.desktop' 2>/dev/null
    done
}

application="$(applications | dmenu application)"
test -z "$application" && exit 1

grep -q "^Type=Application" "$application" || exit 1
grep -q "^Terminal=true" "$application" && exit 1

command="$(grep -Po "^Exec=\K.*" "$application")"
test -z "$command" && exit 1

swaymsg exec -- "$command"
