#!/usr/bin/env bash

if ! type -p fzf >/dev/null; then
    echo "please install fzf" >&2
    exit 1
fi

prompt="$1"
if test -z "$prompt"; then
    echo "please provide a prompt" >&2
    exit 1
fi

dir="$(mktemp --directory --tmpdir="$XDG_CACHE_HOME")"
trap 'rm -r "$dir"' EXIT

in="$dir/in"
out="$dir/out"

mkfifo "$in" "$out"

"$TERMINAL" --app-id launcher sh -c "theme light; fzf --prompt '$1 ' <$in >$out" 2>/dev/null &
cat <"$out" &
cat >"$in"

wait
